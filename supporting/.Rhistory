curdir <- dirname(rstudioapi::getSourceEditorContext()$path)
subdir <- paste0(curdir, "/supporting/")
setwd(subdir)
source("bernEst_startup.R")
men_df <- adj_df[adj_df$Condition=="Manual",]
#is the distribution of added num responses significantly different from a normal curve
#noise hypothesis nls
noise_hyp_nls <- nls(GroupDiff_NumAdj ~ scale*dnorm(AdjSize,0,stdev), data=men_df[abs(men_df$AdjSize) & men_df$AdjSize!=0,],start = c(scale=100,stdev=1))
#store parameter fits
stdev <- coef(noise_hyp_nls)["stdev"]
mean <- 0
scaler <- coef(noise_hyp_nls)["scale"]
#what if we make it a mixture of two distributions
#mixture of noise and true adjustments nls
mixture_hyp_nls <- nls(GroupDiff_NumAdj ~ noise_scale*dnorm(AdjSize,0,noise_stdev) + truresp_scale*dnorm(AdjSize,truresp_mean,truresp_stdev), data=men_df[men_df$AdjSize!=0,],start = c(noise_scale=100,noise_stdev=1,truresp_scale=100,truresp_stdev=1,truresp_mean=3))
noise_hyp <- c(mean=0,
scale=coef(mixture_hyp_nls)[["noise_scale"]],
stdev=coef(mixture_hyp_nls)[["noise_stdev"]])
truresp_hyp <- c(mean=coef(mixture_hyp_nls)[["truresp_mean"]],
scale=coef(mixture_hyp_nls)[["truresp_scale"]],
stdev=coef(mixture_hyp_nls)[["truresp_stdev"]])
hypotheses <- list()
hypotheses[['mix_noise']] <- function(x){
dnorm(x,0,noise_hyp['stdev'])*noise_hyp['scale']
}
hypotheses[['mix_truest']]<- function(x){
dnorm(x,truresp_hyp['mean'],truresp_hyp['stdev'])*truresp_hyp['scale']
}
hypotheses[['mixture']] <- function(x){
hypotheses[['mix_noise']](x) + hypotheses[['mix_truest']](x)
}
hypotheses[['noise']] <- function(x){
dnorm(x,mean,stdev)*scaler
}
plot_addedadj_dist <- function(plot_hypotheses = c("noise","mixture"),
window_size = 8){
#1. df for estimated curve
norm_df <- data.frame(AdjSize=NULL,FitNormCurve=NULL,Hypothesis=NULL)
for (hypothesis in plot_hypotheses) {
adjsizes <- seq(-window_size,window_size,0.2)
norm_df <- rbind(norm_df,data.frame(AdjSize = adjsizes,
FitNormCurve=hypotheses[[hypothesis]](adjsizes),
Hypothesis=hypothesis))
}
#reorder hypothesis to start with noise first
norm_df$Hypothesis <- listreplace(norm_df$Hypothesis,c("noise","mixture"),c("Noise Hypothesis","Mixture Hypothesis"))
norm_df$Hypothesis <- factor(norm_df$Hypothesis,levels=c('Noise Hypothesis','Mixture Hypothesis'))
#2. df for manual participant added adjustments
in_window <- abs(adj_df$AdjSize) <= window_size & adj_df$AdjSize!=0
gg_df <- adj_df[adj_df$Condition=="Manual" & in_window,]
#3. df for horizontal line at zero
line_df <- data.frame(x=c(-window_size,window_size),y=0)
#men_df$FitNormCurve <- estNormCurve
colors <- c("Manual Participant Added Adjustments" = "coral2", "FitNormCurve" = "black")
p <- ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
#scale_color_manual(values = colors)
p <- gg_bernEst(p)
p
}
#scale_color_manual(values = colors)
p <- gg_bernEst(p)
p
p <- plot_addedadj_dist()
p
p <- ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',group=Hypothesis)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',group=Hypothesis)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
plot_addedadj_dist <- function(plot_hypotheses = c("noise","mixture"),
window_size = 8){
#1. df for estimated curve
norm_df <- data.frame(AdjSize=NULL,FitNormCurve=NULL,Hypothesis=NULL)
for (hypothesis in plot_hypotheses) {
adjsizes <- seq(-window_size,window_size,0.2)
norm_df <- rbind(norm_df,data.frame(AdjSize = adjsizes,
FitNormCurve=hypotheses[[hypothesis]](adjsizes),
Hypothesis=hypothesis))
}
#reorder hypothesis to start with noise first
norm_df$Hypothesis <- listreplace(norm_df$Hypothesis,c("noise","mixture"),c("Noise Hypothesis","Mixture Hypothesis"))
norm_df$Hypothesis <- factor(norm_df$Hypothesis,levels=c('Noise Hypothesis','Mixture Hypothesis'))
#2. df for manual participant added adjustments
in_window <- abs(adj_df$AdjSize) <= window_size & adj_df$AdjSize!=0
gg_df <- adj_df[adj_df$Condition=="Manual" & in_window,]
#3. df for horizontal line at zero
line_df <- data.frame(x=c(-window_size,window_size),y=0)
#men_df$FitNormCurve <- estNormCurve
colors <- c("Manual Participant Added Adjustments" = "coral2", "FitNormCurve" = "black")
p <- ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',group=Hypothesis)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
#scale_color_manual(values = colors)
p <- gg_bernEst(p)
p
}
plot_addedadj_dist()
#1. df for estimated curve
norm_df <- data.frame(AdjSize=NULL,FitNormCurve=NULL,Hypothesis=NULL)
plot_hypotheses = c("noise","mixture")
window_size = 8
#1. df for estimated curve
norm_df <- data.frame(AdjSize=NULL,FitNormCurve=NULL,Hypothesis=NULL)
for (hypothesis in plot_hypotheses) {
adjsizes <- seq(-window_size,window_size,0.2)
norm_df <- rbind(norm_df,data.frame(AdjSize = adjsizes,
FitNormCurve=hypotheses[[hypothesis]](adjsizes),
Hypothesis=hypothesis))
}
#reorder hypothesis to start with noise first
norm_df$Hypothesis <- listreplace(norm_df$Hypothesis,c("noise","mixture"),c("Noise Hypothesis","Mixture Hypothesis"))
norm_df$Hypothesis <- factor(norm_df$Hypothesis,levels=c('Noise Hypothesis','Mixture Hypothesis'))
#2. df for manual participant added adjustments
in_window <- abs(adj_df$AdjSize) <= window_size & adj_df$AdjSize!=0
gg_df <- adj_df[adj_df$Condition=="Manual" & in_window,]
#3. df for horizontal line at zero
line_df <- data.frame(x=c(-window_size,window_size),y=0)
colors <- c("Manual Participant Added Adjustments" = "coral2", "FitNormCurve" = "black")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',group=Hypothesis)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black',group=Hypothesis),color='black')+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black',group=Hypothesis,size=1),color='black')+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black',group=Hypothesis,size=0.5),color='black')+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black',group=Hypothesis),color='black')+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
p <- ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black',group=Hypothesis),color='black')+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
#scale_color_manual(values = colors)
p <- gg_bernEst(p)
p
norm_df$Hypothesis
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis"], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black',linetype="dashed"),color='black')+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
goem_line
geom_line
?geom_line
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',linetype="dashed")+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2")+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',size=1)+
geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',linetype="dashed",size=1)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2",size=1.2)+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',size=1)+
geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',linetype="dashed",size=1)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral3"), fun='mean', color="coral3",size=1.2)+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',size=1)+
geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',linetype="dashed",size=1)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral4"), fun='mean', color="coral4",size=1.2)+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',size=1)+
geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',linetype="dashed",size=1)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
p <- ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral4"), fun='mean', color="coral4",size=1.2)+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',size=1)+
geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',linetype="dashed",size=1)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
#scale_color_manual(values = colors)
p <- gg_bernEst(p)
p
ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2",size=1.2)+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',size=1)+
geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',linetype="dashed",size=1)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
p <- ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2",size=1.2)+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
#geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black')+
geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',size=1)+
geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',linetype="dashed",size=1)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
#facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
#scale_color_manual(values = colors)
p <- gg_bernEst(p)
p
p <- ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2",size=1.2)+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',size=1)+
#geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',size=1)+
#geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',linetype="dashed",size=1)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
facet_wrap(~Hypothesis,ncol=1)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
#scale_color_manual(values = colors)
p <- gg_bernEst(p)
p
p <- ggplot()+
stat_summary(data=gg_df, geom = "line", aes(x=AdjSize,y=GroupDiff_NumAdj, color="coral2"), fun='mean', color="coral2",size=1.2)+
geom_point(data=gg_df, aes(x=AdjSize,y=GroupDiff_NumAdj,  color='coral2'),alpha=0.2, color="coral2")+
geom_line(data=norm_df, aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',size=1)+
#geom_line(data=norm_df[norm_df$Hypothesis=="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',size=1)+
#geom_line(data=norm_df[norm_df$Hypothesis!="Noise Hypothesis",], aes(x=AdjSize,y=FitNormCurve, color='black'),color='black',linetype="dashed",size=1)+
geom_vline(xintercept=0, color = "grey75", size=10)+
geom_line(data=line_df, aes(x=x,y=y),linetype="dashed")+
facet_wrap(~Hypothesis)+
labs(y = "Number of Adjustments",
x = "Adjustment Size (Deviation from Previous Response)",
color = "Legend")
#scale_color_manual(values = colors)
p <- gg_bernEst(p)
p
library(data.table)
setwd("./data/")
